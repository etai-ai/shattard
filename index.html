<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>SHATTARD: AWAKEN</title>
<link rel="stylesheet" href="styles.css">
<script src="https://sdk.crazygames.com/crazygames-sdk-v2.js"></script>
</head>
<body>
<canvas id="rain"></canvas>
<div id="scanlines"></div>
<div id="flashOverlay"></div>

<!-- PAUSE -->
<div id="pauseOverlay">
  <div class="pause-title">PAUSED</div>
  <div class="pause-hint">press P or tap to resume</div>
  <button class="pause-btn" onclick="togglePause()">RESUME</button>
  <button class="pause-btn quit" onclick="quitToTitle()">QUIT</button>
</div>

<div id="waveAnnounce">
  <div class="wave-number" id="waveNumber"></div>
  <div class="wave-desc" id="waveDesc"></div>
</div>

<div id="breatherBar">
  <div class="breather-label">NEXT WAVE INCOMING</div>
  <div class="breather-track"><div class="breather-fill" id="breatherFill"></div></div>
</div>

<!-- TUTORIAL -->
<div id="tutorial">
  <div class="tutorial-step active" data-step="0">
    <div class="tut-icon"><canvas id="tutMove" width="160" height="160"></canvas></div>
    <div class="tut-title">MOVE</div>
    <div class="tut-desc">DRAG or SWIPE to move your avatar<br>On desktop, CLICK and DRAG</div>
    <div class="tut-dots"><div class="tut-dot active"></div><div class="tut-dot"></div><div class="tut-dot"></div><div class="tut-dot"></div></div>
    <div class="tut-nav"><button class="tut-btn skip" onclick="closeTutorial()">SKIP</button><button class="tut-btn" onclick="nextTutStep()">NEXT</button></div>
  </div>
  <div class="tutorial-step" data-step="1">
    <div class="tut-icon"><canvas id="tutCollect" width="160" height="160"></canvas></div>
    <div class="tut-title">COLLECT</div>
    <div class="tut-desc">Catch <span style="color:#00ff41">GREEN</span> glyphs for points<br>Build combos for score multipliers</div>
    <div class="tut-dots"><div class="tut-dot"></div><div class="tut-dot active"></div><div class="tut-dot"></div><div class="tut-dot"></div></div>
    <div class="tut-nav"><button class="tut-btn skip" onclick="closeTutorial()">SKIP</button><button class="tut-btn" onclick="nextTutStep()">NEXT</button></div>
  </div>
  <div class="tutorial-step" data-step="2">
    <div class="tut-icon"><canvas id="tutDodge" width="160" height="160"></canvas></div>
    <div class="tut-title">DODGE</div>
    <div class="tut-desc">Avoid <span style="color:#ff3333">RED</span> threats — they cost a life<br><span style="color:#ffaa00">Near misses</span> earn bonus points!</div>
    <div class="tut-dots"><div class="tut-dot"></div><div class="tut-dot"></div><div class="tut-dot active"></div><div class="tut-dot"></div></div>
    <div class="tut-nav"><button class="tut-btn skip" onclick="closeTutorial()">SKIP</button><button class="tut-btn" onclick="nextTutStep()">NEXT</button></div>
  </div>
  <div class="tutorial-step" data-step="3">
    <div class="tut-icon"><canvas id="tutSlow" width="160" height="160"></canvas></div>
    <div class="tut-title">BULLET TIME</div>
    <div class="tut-desc">DOUBLE-TAP or DOUBLE-CLICK<br>to slow time — use wisely!</div>
    <div class="tut-dots"><div class="tut-dot"></div><div class="tut-dot"></div><div class="tut-dot"></div><div class="tut-dot active"></div></div>
    <div class="tut-nav"><button class="tut-btn" onclick="closeTutorial()">LET'S GO</button></div>
  </div>
</div>

<div id="titleScreen" class="screen">
  <h1>SHATTARD</h1>
  <div class="subtitle">awaken</div>
  <button class="start-btn" onclick="startGame()">IN</button>
  <div class="title-nav">
    <button class="start-btn" style="margin-top:0;padding:0.7rem 1.5rem;font-size:0.8rem" onclick="showStats()">STATS</button>
  </div>
  <div class="instructions">SWIPE or DRAG to move<br>COLLECT green glyphs // DODGE red threats<br>DOUBLE TAP for bullet time // P to pause</div>
</div>

<!-- STATS SCREEN -->
<div id="statsScreen">
  <div class="stats-title">OPERATOR RECORD</div>
  <div class="stats-grid" id="statsGrid"></div>
  <button class="start-btn stats-back" onclick="hideStats()">BACK</button>
</div>

<div id="hud" class="hidden">
  <div>
    <div class="hud-score">SCORE: <span id="scoreDisplay">0</span></div>
    <div class="hud-combo" id="comboDisplay"></div>
  </div>
  <div class="hud-wave" id="waveDisplay">WAVE 1</div>
  <div style="display:flex;align-items:center"><div class="hud-lives" id="livesDisplay"></div><button class="hud-pause" onclick="togglePause()" aria-label="Pause">⏸</button></div>
</div>

<div id="slowMoBar" class="hidden"><div id="slowMoFill" style="width:100%"></div></div>
<div class="slowmo-label hidden" id="slowMoLabel">BULLET TIME</div>
<canvas id="gameCanvas" class="hidden"></canvas>

<div id="gameOver" class="screen hidden">
  <h2>SYSTEM FAILURE</h2>
  <div class="new-best hidden" id="newBestBadge">★ NEW BEST ★</div>
  <div class="final-score" id="finalScore">0</div>
  <div class="high-score" id="highScoreDisplay"></div>
  <div class="stats" id="finalStats"></div>
  <button class="start-btn" onclick="startGame()">REBOOT</button>
  <div class="new-best-particles" id="newBestParticles"></div>
</div>

<script src="game.js"></script>
</body>
</html>
